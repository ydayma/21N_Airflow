[2021-06-16 13:28:38,692] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: summary_db.queue_state 2021-06-15T02:30:00+00:00 [queued]>
[2021-06-16 13:28:38,749] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: summary_db.queue_state 2021-06-15T02:30:00+00:00 [queued]>
[2021-06-16 13:28:38,750] {taskinstance.py:1067} INFO - 
--------------------------------------------------------------------------------
[2021-06-16 13:28:38,750] {taskinstance.py:1068} INFO - Starting attempt 4 of 6
[2021-06-16 13:28:38,750] {taskinstance.py:1069} INFO - 
--------------------------------------------------------------------------------
[2021-06-16 13:28:38,773] {taskinstance.py:1087} INFO - Executing <Task(PythonOperator): queue_state> on 2021-06-15T02:30:00+00:00
[2021-06-16 13:28:38,784] {standard_task_runner.py:52} INFO - Started process 2579 to run task
[2021-06-16 13:28:38,790] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'summary_db', 'queue_state', '2021-06-15T02:30:00+00:00', '--job-id', '259', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/first_dag.py', '--cfg-path', '/tmp/tmppctltwlw', '--error-file', '/tmp/tmpjyigw3n5']
[2021-06-16 13:28:38,799] {standard_task_runner.py:77} INFO - Job 259: Subtask queue_state
[2021-06-16 13:28:38,881] {logging_mixin.py:104} INFO - Running <TaskInstance: summary_db.queue_state 2021-06-15T02:30:00+00:00 [running]> on host ac3e7c1eb084
[2021-06-16 13:28:38,947] {taskinstance.py:1282} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=summary_db
AIRFLOW_CTX_TASK_ID=queue_state
AIRFLOW_CTX_EXECUTION_DATE=2021-06-15T02:30:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-06-15T02:30:00+00:00
[2021-06-16 13:28:38,948] {logging_mixin.py:104} INFO - ------------------------------------Inside Function-----------------------------
[2021-06-16 13:28:46,825] {logging_mixin.py:104} INFO - -------------------------------Data read into dataframe---------------------------
[2021-06-16 13:28:50,028] {taskinstance.py:1481} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 148, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 236, in executemany
    self._get_db().encoding,
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 261, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 206, in execute
    res = self._query(query)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 319, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/connections.py", line 259, in query
    _mysql.connection.query(self, query)
MySQLdb._exceptions.IntegrityError: (1062, "Duplicate entry '30392679' for key 'PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1137, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1311, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1341, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 150, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 161, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/first_dag.py", line 434, in queue_state
    index=False)
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/core/generic.py", line 2615, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/io/sql.py", line 598, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/io/sql.py", line 1406, in to_sql
    raise err
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/io/sql.py", line 1398, in to_sql
    table.insert(chunksize, method=method)
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/io/sql.py", line 830, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.6/site-packages/pandas/io/sql.py", line 747, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 148, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 236, in executemany
    self._get_db().encoding,
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 261, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 206, in execute
    res = self._query(query)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/cursors.py", line 319, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.6/site-packages/MySQLdb/connections.py", line 259, in query
    _mysql.connection.query(self, query)
sqlalchemy.exc.IntegrityError: (MySQLdb._exceptions.IntegrityError) (1062, "Duplicate entry '30392679' for key 'PRIMARY'")
[SQL: INSERT INTO analytics.`21N_queue_state` (id, creationdate, queueid, active, state, state_status, service_status, ambassador_id, notes, requestedby, latitude, longitude, isaccepted, `Etd`) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ((30392679, datetime.datetime(2021, 6, 15, 18, 58, 42), 1636246, 0, 7, 2, 2, 840999, 'Updated from Ambassador App - On the way to Customer', None, '18.66201826', '73.7925809', 0, None), (30392680, datetime.datetime(2021, 6, 15, 18, 58, 44), 1638194, 0, 6, 2, 2, 867211, 'Updated from Ambassador App - Covid Safety Photographs at Service Centre', None, '21.1314083', '79.06585', 0, None), (30392681, datetime.datetime(2021, 6, 15, 18, 58, 46), 1635490, 0, 7, 2, 2, 868373, 'Updated from Ambassador App - On the way to Customer', None, '22.9925632', '72.5349334', 0, None), (30392682, datetime.datetime(2021, 6, 15, 18, 58, 46), 1636344, 0, 9, 0, 2, 146461, 'Updated from Ambassador App - Waiting for Payment', None, '28.71858046', '77.12717465', 0, None), (30392683, datetime.datetime(2021, 6, 15, 18, 58, 55), 1636676, 0, 9, 0, 2, 778719, 'Updated from Ambassador App - Waiting for Payment', None, '18.98047682', '72.83055504', 0, None), (30392684, datetime.datetime(2021, 6, 15, 18, 59, 1), 1636854, 0, 10, 0, 3, 0, '', None, None, None, 0, None), (30392685, datetime.datetime(2021, 6, 15, 18, 59, 1), 1638213, 0, 9, 0, 2, 825033, 'Updated from Ambassador App - Waiting for Payment', None, '28.4865824', '77.1070373', 0, None), (30392686, datetime.datetime(2021, 6, 15, 18, 59, 3), 1636878, 0, 7, 2, 2, 778370, 'Updated from Ambassador App - On the way to Customer', None, '22.992504999999998', '72.535155', 0, None)  ... displaying 10 of 13848 total bound parameter sets ...  (30406678, datetime.datetime(2021, 6, 16, 10, 4, 44), 1634238, 0, 7, 0, 2, 533636, 'Updated from Ambassador App - Reached Service Centre', None, '23.094130754470825', '72.66434669494629', 0, None), (30406679, datetime.datetime(2021, 6, 16, 10, 4, 46), 1638498, 0, 2, 1, 5, 843025, 'Updated from Ambassador App - Digital Inventory', None, '26.47297681', '80.25788085', 0, None))]
(Background on this error at: http://sqlalche.me/e/13/gkpj)
[2021-06-16 13:28:50,104] {taskinstance.py:1531} INFO - Marking task as UP_FOR_RETRY. dag_id=summary_db, task_id=queue_state, execution_date=20210615T023000, start_date=20210616T132838, end_date=20210616T132850
[2021-06-16 13:28:50,185] {local_task_job.py:151} INFO - Task exited with return code 1
